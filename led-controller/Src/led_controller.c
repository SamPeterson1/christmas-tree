#include "led_controller.h"

const float led_positions[450][3] = {
    {1.1100445, -2.253343, 4.904303},
    {5.363123, -3.733226, 12.333179},
    {2.524232, -2.4261467, 8.359518},
    {3.304331, -3.9700482, 8.907232},
    {5.492359, -5.540722, 9.169733},
    {6.116932, -3.9748101, 7.780461},
    {6.980949, -2.9461026, 8.740487},
    {8.111871, -2.4762871, 10.604259},
    {8.111871, -2.4762871, 10.604259},
    {9.27095, -0.7144139, 13.603639},
    {3.964703, 1.2077942, 9.778484},
    {5.423917, 2.9743204, 10.773302},
    {4.9450107, 1.6425562, 10.56506},
    {3.267409, 0.6444086, 6.845958},
    {3.267409, 0.6444086, 6.845958},
    {3.7947974, 5.5996666, 11.322008},
    {3.7947974, 5.5996666, 11.322008},
    {0.2770887, 2.1095166, 6.876048},
    {0.2770887, 2.1095166, 6.876048},
    {-0.74093866, 4.76647, 10.972764},
    {-2.240593, 5.8426533, 12.537982},
    {-2.240593, 5.8426533, 12.537982},
    {-3.432495, 4.6619396, 11.162167},
    {-4.6243973, 3.481226, 9.786352},
    {-4.6243973, 3.481226, 9.786352},
    {-6.2473297, 2.2593346, 12.931525},
    {-6.2473297, 2.2593346, 12.931525},
    {-8.067759, 0.26391113, 13.865469},
    {-8.067759, 0.26391113, 13.865469},
    {-6.8408613, -0.55997884, 12.729089},
    {-5.613964, -1.3838688, 11.592709},
    {-4.387067, -2.207759, 10.456327},
    {-3.1601696, -3.0316486, 9.319947},
    {-5.7134805, -5.340584, 11.389162},
    {-4.4037223, -5.0684185, 10.875845},
    {-2.3778658, -6.295533, 9.846373},
    {-3.8524442, -3.5632248, 9.581386},
    {-1.6181097, -4.8046694, 9.949229},
    {-0.28454837, -6.1543326, 10.397316},
    {0.9075408, -5.6277714, 11.057638},
    {0.10458839, -2.5010962, 8.260196},
    {1.7023455, -3.1627305, 8.018749},
    {2.7316399, -3.6283877, 8.491549},
    {5.8171124, -6.604805, 9.665053},
    {5.8811026, -3.9449599, 7.601121},
    {5.8811026, -3.9449599, 7.601121},
    {5.6405993, -2.4374406, 7.4628315},
    {5.4000955, -0.9299214, 7.3245416},
    {5.159592, 0.5775978, 7.186252},
    {6.885402, 1.2741809, 9.572552},
    {6.885402, 1.2741809, 9.572552},
    {2.6508162, 3.0653996, 5.025268},
    {4.877873, 6.510815, 9.059467},
    {4.877873, 6.510815, 9.059467},
    {2.0824156, 5.173253, 6.3022556},
    {0.3690712, 6.154316, 6.8067},
    {0.3690712, 6.154316, 6.8067},
    {-0.61160344, -3.523669, 5.1035953},
    {-1.2979041, 5.3909254, 5.8361707},
    {-1.4679457, 4.9952474, 6.0541034},
    {-1.4679457, 4.9952474, 6.0541034},
    {-3.3923588, 3.7549171, 6.3283825},
    {-5.3167715, 2.514587, 6.602661},
    {-5.3167715, 2.514587, 6.602661},
    {-5.606225, 1.332123, 7.8536315},
    {-5.8956785, 0.14965916, 9.104602},
    {-6.185132, -1.0328046, 10.355572},
    {-7.9634676, -2.4729083, 11.15214},
    {-5.8092623, -3.6701877, 8.390954},
    {-5.661537, -4.4082427, 8.87728},
    {-5.855937, -5.5309954, 7.917042},
    {-5.942175, -8.783111, 8.746302},
    {-5.684885, -9.909498, 10.018705},
    {-4.65507, -8.355232, 11.068396},
    {-0.34553763, -5.641407, 8.456863},
    {-0.3503008, -4.4469643, 7.41922},
    {-0.46010733, -6.3703327, 10.658732},
    {0.72967446, -6.434967, 9.504973},
    {0.72967446, -6.434967, 9.504973},
    {1.7616756, -6.1961756, 7.388514},
    {2.9748552, -5.3303986, 7.9440947},
    {1.4549099, -4.478594, 8.153585},
    {6.139942, -7.3442554, 11.06909},
    {6.736015, -4.36214, 9.220753},
    {6.736015, -4.36214, 9.220753},
    {6.21338, -2.9942787, 7.089099},
    {6.627072, -2.5792062, 5.401022},
    {6.4724593, -1.32382, 4.938177},
    {6.4724593, -1.32382, 4.938177},
    {6.8129153, 0.79263353, 7.167202},
    {5.758216, 1.6359789, 6.319345},
    {5.9542437, 3.0462177, 6.3283753},
    {4.268863, 2.9874005, 6.1226125},
    {2.8506007, 3.0251524, 4.9554696},
    {5.124864, 6.9850044, 8.146332},
    {3.774516, 4.7637396, 8.338615},
    {2.7609231, 4.7832456, 8.754525},
    {1.3995315, 3.5041203, 7.7156596},
    {2.0822663, 3.509542, 6.1898727},
    {2.0822663, 3.509542, 6.1898727},
    {-1.6317639, 3.5372016, 9.459631},
    {-4.0844564, 6.3506804, 12.326915},
    {-2.8580942, 3.3541996, 9.057896},
    {-4.082519, 3.580822, 10.032378},
    {-4.261909, 2.518892, 9.135842},
    {-4.605625, 1.9023702, 7.7308006},
    {-4.605625, 1.9023702, 7.7308006},
    {-4.514104, -0.071529835, 8.630657},
    {-3.5404928, -1.6668605, 6.067308},
    {-4.2010694, -2.2073524, 8.718224},
    {-3.6242409, -3.415503, 8.287562},
    {-3.6242409, -3.415503, 8.287562},
    {-3.3711777, -5.9991436, 8.176942},
    {-0.80002445, -2.941316, 5.327158},
    {-0.6369591, -4.869236, 5.9159307},
    {-0.6369591, -4.869236, 5.9159307},
    {0.66010344, -3.1292582, 5.6378703},
    {0.66010344, -3.1292582, 5.6378703},
    {4.205157, -5.428242, 7.6983957},
    {4.205157, -5.428242, 7.6983957},
    {5.1736193, -4.3192463, 7.2667513},
    {6.1420813, -3.2102509, 6.8351073},
    {6.1420813, -3.2102509, 6.8351073},
    {5.6315713, -1.6422193, 6.6636906},
    {5.121061, -0.074187756, 6.4922743},
    {4.610551, 1.4938436, 6.3208575},
    {4.610551, 1.4938436, 6.3208575},
    {4.72984, 3.013362, 6.34593},
    {4.8491287, 4.5328803, 6.371003},
    {5.572812, 6.308738, 8.484771},
    {5.572812, 6.308738, 8.484771},
    {4.100275, 8.513976, 10.484681},
    {0.8168433, 4.080256, 5.4350166},
    {1.2312647, 6.690823, 9.817602},
    {0.905921, 8.320278, 10.954052},
    {-0.8189877, 4.842498, 7.813021},
    {-0.98907405, 7.3160915, 7.8506107},
    {-1.5338554, 6.7568107, 7.2701745},
    {-1.5338554, 6.7568107, 7.2701745},
    {-5.8193245, 7.9679356, 9.707833},
    {-5.894827, 6.2843237, 9.592086},
    {-5.600868, 4.650452, 9.270802},
    {-5.86631, 2.942289, 8.852925},
    {-6.7629547, 2.0536673, 8.684294},
    {-7.613656, 0.39550763, 8.865856},
    {-10.514295, -0.49173015, 10.900098},
    {-9.650764, -1.3811746, 9.995586},
    {-6.4720817, -2.4282174, 8.283547},
    {-3.1508605, -1.2701726, 6.614772},
    {-3.1508605, -1.2701726, 6.614772},
    {-2.0673504, -2.085878, 6.066006},
    {-0.9838402, -2.9015834, 5.5172405},
    {0.09966987, -3.7172887, 4.968475},
    {-0.2588601, -3.8936803, 3.700354},
    {-0.44306064, -3.5086222, 3.2901123},
    {3.1027632, -1.8911989, 4.4466357},
    {2.2811565, -2.2268023, 4.4250526},
    {2.2811565, -2.2268023, 4.4250526},
    {3.3777242, -0.49454123, 3.7960582},
    {3.652987, 0.15125471, 4.7700553},
    {2.0718591, 0.91178876, 3.6699371},
    {2.3469152, 1.5442915, 4.214283},
    {2.470401, 1.6709038, 3.2212687},
    {2.8775373, 4.374273, 3.9878142},
    {1.190668, 4.267039, 2.1572003},
    {0.8132032, 4.994406, 2.006824},
    {1.0311404, 2.7587814, 2.407371},
    {0.024232984, 3.7025385, 4.2777143},
    {0.024232984, 3.7025385, 4.2777143},
    {-2.7009602, 4.0664024, 5.5633683},
    {-2.2320466, 2.0447404, 4.7749944},
    {-2.2320466, 2.0447404, 4.7749944},
    {-5.0409584, 2.0299692, 5.296732},
    {-5.8036695, 1.0462798, 5.151652},
    {-4.762082, -0.06611341, 4.7291546},
    {-4.762082, -0.06611341, 4.7291546},
    {-5.160754, -2.199802, 5.9372425},
    {-5.160754, -2.199802, 5.9372425},
    {-4.2616844, -2.12881, 4.393256},
    {-3.362615, -2.0578182, 2.8492699},
    {-3.003273, -3.099806, 2.8753622},
    {-2.0023925, -3.6682177, 3.8329606},
    {-1.6393301, -4.9813023, 5.7229443},
    {-0.48682082, -4.629054, 5.03825},
    {-0.23869681, -6.211361, 5.0822706},
    {0.8013702, -4.0663424, 3.522606},
    {2.6863, -7.2428746, 5.6663775},
    {2.6254697, -7.050006, 7.5894513},
    {2.5287802, -3.3066342, 6.2002106},
    {2.5287802, -3.3066342, 6.2002106},
    {2.0641456, -2.3047411, 4.9715433},
    {4.2414002, -2.0134017, 4.7755127},
    {4.256566, -1.2317245, 4.5766954},
    {4.256566, -1.2317245, 4.5766954},
    {4.497392, -0.17718744, 5.295973},
    {4.7382183, 0.87734973, 6.0152497},
    {4.7382183, 0.87734973, 6.0152497},
    {3.5097008, 3.1843498, 6.2195415},
    {4.0515137, 3.3880808, 5.314296},
    {3.7167585, 5.194284, 5.271071},
    {3.7167585, 5.194284, 5.271071},
    {0.47240832, 5.034415, 4.351321},
    {0.47240832, 5.034415, 4.351321},
    {-0.56657815, 5.463133, 3.7591498},
    {-1.033916, 3.5917962, 3.9222734},
    {-2.328177, 2.9740887, 3.5784757},
    {-2.328177, 2.9740887, 3.5784757},
    {-3.1864855, 2.3968377, 3.0618463},
    {-4.044794, 1.8195866, 2.545217},
    {-4.9031024, 1.2423357, 2.0285878},
    {-4.9586086, 0.65858525, 1.9069738},
    {-3.8196554, 0.0457626, 1.0611632},
    {-5.7809243, -1.5034511, 2.9194965},
    {-5.7809243, -1.5034511, 2.9194965},
    {-4.8794193, -3.6424005, 2.3446875},
    {-4.172805, -4.3643737, 2.6667647},
    {-2.5319533, -3.9277596, 2.3818583},
    {-1.729093, -3.4837372, 2.963727},
    {-1.5839676, -6.284784, 3.1051717},
    {-0.25370532, -4.016949, 2.6299157},
    {1.280641, -4.7402315, 2.5405965},
    {1.5764307, -5.838603, 2.9386144},
    {1.4770641, -4.294841, 2.3097126},
    {4.4478264, -6.2642393, 3.7648568},
    {3.970279, -3.142094, 3.2338848},
    {3.970279, -3.142094, 3.2338848},
    {3.6771913, -1.8790665, 4.220996},
    {2.7642684, -0.70990384, 3.7409472},
    {3.776104, 0.26647744, 5.0462947},
    {2.9934034, 0.43139362, 4.198287},
    {2.9934034, 0.43139362, 4.198287},
    {3.0827959, 2.7705297, 3.3782032},
    {3.0827959, 2.7705297, 3.3782032},
    {2.1200352, 3.4445238, 1.0354614},
    {2.3038008, 3.0716693, 2.0963855},
    {2.7143254, 7.2131896, 3.504141},
    {0.8674442, 3.9608102, 2.7398155},
    {-0.4943338, 5.029667, 1.3552371},
    {-2.0553098, 4.26264, 1.9755844},
    {-2.0771735, 4.911712, 2.664347},
    {-3.3761213, 3.1285543, 2.880677},
    {-3.546632, 3.35571, 3.114394},
    {-4.5570116, 3.600955, 3.71663},
    {-5.3540506, 2.0489697, 3.7552426},
    {-3.342845, 0.82899946, 2.8056145},
    {-7.00284, -0.47661257, 2.5828314},
    {-5.914753, -1.3606901, 2.4710865},
    {-5.6579933, -2.0998611, 2.4573836},
    {-4.258085, -2.9671226, 2.2341886},
    {-3.1923683, -3.816394, 1.8748624},
    {-1.4980959, -3.9407885, 1.135092},
    {-0.24709196, -4.1542063, 1.098991},
    {0.81359226, -4.4333873, 1.7031826},
    {2.042873, -4.49267, 1.7477729},
    {2.042873, -4.49267, 1.7477729},
    {3.9911754, -4.0078015, 1.9872949},
    {3.5382373, -1.7133667, 1.6345621},
    {3.5382373, -1.7133667, 1.6345621},
    {6.363424, -0.44175175, 0.77056694},
    {5.6482506, 0.75768816, 1.5896198},
    {5.292377, 1.4310039, 0.91877484},
    {6.12486, 2.2167487, 1.370214},
    {3.9715497, 2.9135714, 1.3718274},
    {2.6799834, 2.694937, 1.2215937},
    {2.7320478, 4.504732, 1.2192516},
    {1.383058, 4.5023046, 1.0102656},
    {0.5634409, 2.5463963, 0.02730228},
    {-0.57529175, 3.706411, 0.5622109},
    {-0.57529175, 3.706411, 0.5622109},
    {-2.3515675, 3.8559177, 0.29754},
    {-2.3515675, 3.8559177, 0.29754},
    {-4.208663, 1.8672576, 0.31771544},
    {-3.5946038, 0.8574214, 0.038339283},
    {-2.9880726, -0.271955, 0.27034867},
    {-4.873498, -1.3997345, 0.6725599},
    {-2.7872977, -1.8073722, 0.50954974},
    {-3.3570833, -3.4595606, 0.39709306},
    {-1.4541087, -1.9742998, -0.12989976},
    {-1.4541087, -1.9742998, -0.12989976},
    {-0.34078503, -3.1965723, 0.4646244},
    {0.77253854, -4.418845, 1.0591486},
    {0.77253854, -4.418845, 1.0591486},
    {1.4551761, -2.7207177, 0.73232937},
    {3.7155337, -1.7746854, 0.24072792},
    {3.7155337, -1.7746854, 0.24072792},
    {4.5070705, -1.175823, 2.266312},
    {5.489286, -0.7328316, 2.1250312},
    {2.514084, -0.68463594, 1.2555017},
    {2.514084, -0.68463594, 1.2555017},
    {4.404681, 2.0682638, 3.606134},
    {3.8346868, 3.0430496, 3.1134617},
    {3.24855, 3.2157855, 2.3767765},
    {2.0487726, 3.4264588, 1.4100977},
    {2.0487726, 3.4264588, 1.4100977},
    {1.0134469, 4.2164845, 0.45010194},
    {0.37503067, 4.461246, 1.304552},
    {-0.3951164, 3.2874718, 1.2966571},
    {-2.1969721, 3.6900165, 1.3749465},
    {-2.928642, 3.486869, 0.2619572},
    {-2.5107164, 2.2806847, 0.42807525},
    {-2.5107164, 2.2806847, 0.42807525},
    {-3.4178126, -0.11176966, -1.4782408},
    {-3.2495835, -1.170116, -1.4391323},
    {-2.405068, -2.3013136, -2.6790092},
    {-2.8004339, -2.765805, -1.2630255},
    {-1.9617729, -3.2426271, -0.789024},
    {-0.9586347, -4.0929766, -1.415975},
    {-0.82342917, -3.682066, -2.02544},
    {-0.82342917, -3.682066, -2.02544},
    {0.51164925, -3.884366, -1.8118261},
    {0.82074153, -3.0163472, -0.1847372},
    {1.9763204, -3.2130651, 0.22047977},
    {3.3089685, -2.350943, -0.18005389},
    {3.041465, -1.3222177, -0.4136052},
    {4.2399282, -1.0642809, -0.8251551},
    {4.5073195, 0.4283019, -1.8462425},
    {2.843327, 0.06250963, -0.24798626},
    {2.4109015, 1.4151393, -0.21616541},
    {2.4109015, 1.4151393, -0.21616541},
    {2.2535524, 3.745433, -1.2239814},
    {1.1964732, 2.4189878, -0.14776865},
    {0.21479312, 2.4717848, -0.04638132},
    {-0.3551257, 2.2979748, 0.02509199},
    {-1.4141169, 4.321153, -0.6559961},
    {-1.4262987, 1.2896116, -1.0547723},
    {-1.1555995, 1.9473404, -0.28067783},
    {-3.9416535, 1.9658246, -0.70691705},
    {-4.63027, 1.3061588, -0.96273816},
    {-3.7594132, 0.4862372, -1.1555982},
    {-3.526552, -0.7569471, -1.2518084},
    {-3.923943, -1.687447, -2.188351},
    {-3.7696238, -2.085217, -2.231542},
    {-2.7697911, -3.0630746, -2.9721088},
    {-2.7697911, -3.0630746, -2.9721088},
    {-1.9048796, -3.1083424, -3.0492065},
    {-1.0399681, -3.1536102, -3.126304},
    {-0.1750568, -3.198878, -3.2034016},
    {-0.20408136, -1.8109078, -2.7234907},
    {-0.20408136, -1.8109078, -2.7234907},
    {0.023020625, -1.2371793, -2.5720165},
    {0.2501226, -0.6634507, -2.4205422},
    {0.4772246, -0.08972216, -2.269068},
    {0.70432657, 0.4840064, -2.1175938},
    {0.9314285, 1.057735, -1.9661198},
    {1.1585305, 1.6314635, -1.8146455},
    {1.3856324, 2.205192, -1.6631713},
    {1.7482383, 2.7497914, -1.7822566},
    {2.617156, 5.03914, -1.905515},
    {1.9338471, 4.212578, -0.26013726},
    {0.94466853, 3.9542859, 0.040503602},
    {0.0656916, 2.7091942, -1.2295386},
    {-0.32432792, 3.6657584, -0.97586066},
    {-0.81060636, -7.204993, -1.0401199},
    {-2.796939, 1.8152807, -2.0831363},
    {-3.5265608, 1.2403045, -2.4166691},
    {-3.3876145, 0.0129378205, -2.67213},
    {-3.7516227, -0.77441186, -2.625328},
    {-3.075998, -1.5417677, -2.1775448},
    {-3.075998, -1.5417677, -2.1775448},
    {-1.5502739, -3.1054544, -3.7628884},
    {-1.5502739, -3.1054544, -3.7628884},
    {0.8886353, -3.202956, -3.46272},
    {2.2021089, -1.8286631, -3.3823254},
    {2.934702, -2.504507, -4.3858795},
    {3.0490315, -0.72038805, -3.8454819},
    {3.1321304, -0.078044176, -3.2710881},
    {3.3416538, 0.4319742, -3.6109982},
    {3.1050496, 0.68900657, -2.0680332},
    {2.9064717, 2.4187343, -2.4042246},
    {2.1199827, 3.120974, -1.981367},
    {2.1199827, 3.120974, -1.981367},
    {0.58813125, 3.757974, -3.0915103},
    {-0.636582, 1.4821441, -2.3538017},
    {-1.6825168, 2.7724543, -2.6390607},
    {-2.810141, 2.256569, -2.4345927},
    {-3.1598518, 1.420343, -2.711801},
    {-3.5142703, 0.6407782, -3.3680758},
    {-3.778926, 0.20696323, -5.587001},
    {-3.5703611, -0.8061292, -5.094603},
    {-1.4621665, -1.2351068, -4.2496204},
    {-1.4621665, -1.2351068, -4.2496204},
    {-0.4176054, -1.6442946, -5.009733},
    {0.62695575, -2.0534823, -5.769846},
    {1.6715165, -2.46267, -6.5299587},
    {1.6715165, -2.46267, -6.5299587},
    {1.941596, -1.6727283, -4.6082015},
    {1.941596, -1.6727283, -4.6082015},
    {2.6220918, 0.15555567, -3.5787404},
    {2.6220918, 0.15555567, -3.5787404},
    {1.9124146, 1.8197176, -4.051987},
    {1.2027375, 3.4838796, -4.525234},
    {-0.53393126, 3.1091933, -4.5209374},
    {-0.954998, 2.238245, -3.8581033},
    {-1.5621037, 1.3963693, -3.74651},
    {-1.5621037, 1.3963693, -3.74651},
    {-2.7887223, 0.8142977, -4.9110417},
    {-3.2731354, -0.13989052, -4.650588},
    {-3.2731354, -0.13989052, -4.650588},
    {-2.7728806, -1.8727306, -4.470471},
    {-1.9972132, -2.4554672, -4.6670666},
    {-0.56024766, -3.391304, -5.555957},
    {-0.56024766, -3.391304, -5.555957},
    {1.2988675, -2.4929426, -6.302519},
    {1.8350244, -0.6824406, -6.232424},
    {1.7071964, -0.3530693, -4.8662925},
    {-0.28354764, -1.0792841, -4.4072022},
    {0.09147006, 1.244385, -4.4934497},
    {1.1891763, 2.6853278, -5.383405},
    {-0.25588846, 1.2131779, -5.170491},
    {-0.25588846, 1.2131779, -5.170491},
    {-2.2188363, 3.1017656, -7.062734},
    {-2.3477972, 2.3136587, -5.3904266},
    {-2.9373808, 0.74416953, -5.3502083},
    {-2.761271, -0.14874488, -5.129889},
    {-2.661333, -1.0805502, -5.108776},
    {-2.661333, -1.0805502, -5.108776},
    {-1.2365077, -1.7432224, -5.8095646},
    {0.18831778, -2.4058945, -6.510353},
    {0.9645562, -1.3073926, -6.4286904},
    {1.7836456, -1.6487194, -6.709155},
    {1.5671844, 0.12947623, -7.9134274},
    {0.0047329664, 1.2833704, -6.2030344},
    {0.0047329664, 1.2833704, -6.2030344},
    {-0.69611317, 1.9484584, -6.862985},
    {-1.0484607, 2.1899726, -6.938945},
    {-1.8544865, 1.477077, -6.766409},
    {-2.5127192, 1.1760283, -6.5928755},
    {-2.0147488, -0.65198207, -6.5133834},
    {-0.93720365, -1.0211861, -5.84564},
    {-0.93720365, -1.0211861, -5.84564},
    {0.79975235, -1.681553, -6.67148},
    {1.4191519, -1.6305305, -6.9901795},
    {2.3414104, -1.502387, -8.384742},
    {2.3414104, -1.502387, -8.384742},
    {1.4335737, 1.1967182, -8.222721},
    {1.4335737, 1.1967182, -8.222721},
    {-0.3816619, 1.8835244, -8.053386},
    {-1.820713, 1.372839, -8.982819},
    {-0.8910973, -0.10154852, -7.805548},
    {-2.3072748, 0.43035567, -8.1622305},
    {-0.77951, -1.0429516, -8.562405},
    {-0.2638197, -1.3258772, -8.418688},
    {-0.3369317, -2.1881752, -8.176032},
    {-0.093313456, -1.8099687, -8.665138},
    {0.7814212, -0.19473553, -8.954497},
    {1.5538814, -0.816653, -8.88916},
    {1.5538814, -0.816653, -8.88916},
    {0.004357338, 1.5321112, -10.005747},
    {0.25243568, 1.9331379, -10.190393},
    {-0.4206376, 2.3580265, -9.451143},
};

void led_init(LEDController *controller) {
    for (int i = 0; i < N_LEDS; i++) {
        controller->colors[i].r = 0;
        controller->colors[i].g = 0;
        controller->colors[i].b = 0;
    }

    led_update(controller);

    for (int i = 0; i < N_BLANK_FRAMES * 24; i++) {
        controller->pwm_dma_buf[N_LEDS * 24 + i] = 0;
    }

    init_pwm(controller->pwm_dma_buf, N_LEDS * 24 + N_BLANK_FRAMES * 24);
}

void led_set(LEDController *controller, int i, RGBColor color) {
    controller->colors[i] = color;
}

void led_update(LEDController *controller) {
    for (int i = 0; i < N_LEDS; i++) {
        int j = i * 24;

        int r = controller->colors[i].r;
        int g = controller->colors[i].g;
        int b = controller->colors[i].b;

        for (int bit = 0; bit < 8; bit ++) {
            controller->pwm_dma_buf[j + bit] = (r & (1 << (7 - bit))) ? 16 : 7;
            controller->pwm_dma_buf[j + 8 + bit] = (g & (1 << (7 - bit))) ? 16 : 7;
            controller->pwm_dma_buf[j + 16 + bit] = (b & (1 << (7 - bit))) ? 16 : 7;
        }
    }
}